<html>
  <head>
    <title>Parameter Test</title>
  </head>
  <body>
    <h2>HTA Parameter Test</h2>
    <p>Checking provided URL...</p>
  </body>

  <script language="VBScript">
    Function GetQueryParameter(paramName)
      Dim query, params, i, param, nameValue
      query = Window.Location.search
      params = Split(Mid(query, 2), "&") ' Remove the "?" and split by "&"

      For i = 0 To UBound(params)
        param = params(i)
        nameValue = Split(param, "=")
        If LCase(nameValue(0)) = LCase(paramName) Then
          GetQueryParameter = nameValue(1)
          Exit Function
        End If
      Next
      GetQueryParameter = ""
    End Function

    Sub DisplayURL()
      Dim downloadUrl
      downloadUrl = GetQueryParameter("downloadUrl")

      If downloadUrl = "" Then
        MsgBox "No download URL provided!", vbCritical
      Else
        MsgBox "The provided URL is: " & downloadUrl, vbInformation
      End If
    End Sub

    ' Call the function to display the URL
    DisplayURL
  </script>
</html>
